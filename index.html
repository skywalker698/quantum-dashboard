<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quantum Sugar AI Dashboard</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet" />

  <!-- Bootstrap & DataTables CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: #f7fafc;
      color: #1e293b;
      position: relative;
      overflow-x: hidden;
    }
    /* ‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Quantum + AI Robot */
    body::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: url('https://images.unsplash.com/photo-1581092334188-6f6670ac2a47?auto=format&fit=crop&w=1470&q=80') no-repeat center;
      background-size: cover;
      opacity: 0.05;
      z-index: -1;
    }

    .navbar {
      background-color: #e0f2f1;
    }
    .navbar-brand, .nav-link {
      color: #00695c !important;
      font-weight: 600;
    }

    .card {
      background: #ffffffcc;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      color: #1e293b;
      transition: transform 0.2s;
    }
    .card:hover { transform: scale(1.02); }

    .chart-container {
      background: #ffffffcc;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      padding: 24px;
    }

    .btn-ai {
      background-color: #26a69a;
      color: white;
      border: none;
      transition: transform 0.2s;
    }
    .btn-ai:hover {
      background-color: #00897b;
      transform: scale(1.05);
    }

    footer {
      background: #e0f2f1;
      color: #00695c;
      padding: 16px;
      text-align: center;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö DataTable */
    table.dataTable tbody tr {
      background: #ffffffcc;
    }
    .dataTables_wrapper .dataTables_filter input,
    .dataTables_wrapper .dataTables_length select {
      border-radius: 8px;
      border: 1px solid #cbd5e1;
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg shadow-sm mb-4">
  <div class="container">
    <a class="navbar-brand" href="#">üß† Quantum Sugar AI</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="#">‡∏™‡∏£‡∏∏‡∏õ</a></li>
      <li class="nav-item"><a class="nav-link" href="#">‡∏Å‡∏£‡∏≤‡∏ü</a></li>
      <li class="nav-item"><a class="nav-link" href="#">‡∏ï‡∏≤‡∏£‡∏≤‡∏á</a></li>
    </ul>
  </div>
</nav>

<div class="container">

  <!-- Summary Metrics -->
  <div class="row text-center mb-4">
    <div class="col-md-3"><div class="card p-4"><h5>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°</h5><h3 id="totalRevenue">-</h3></div></div>
    <div class="col-md-3"><div class="card p-4"><h5>‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°</h5><h3 id="totalProfit">-</h3></div></div>
    <div class="col-md-3"><div class="card p-4"><h5>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡πâ‡∏≠‡∏¢</h5><h3 id="totalCane">-</h3></div></div>
    <div class="col-md-3"><div class="card p-4"><h5>ROI ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h5><h3 id="avgROI">-</h3></div></div>
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏° Forecast -->
  <div class="text-end mb-3">
    <button id="toggleForecast" class="btn btn-ai">üéØ ‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡πÇ‡∏î‡∏¢ AI</button>
  </div>

  <!-- Trend Chart -->
  <div class="chart-container mb-4">
    <h4 class="text-center mb-4">üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 10 ‡∏õ‡∏µ</h4>
    <canvas id="trendChart" height="100"></canvas>
  </div>

  <!-- Forecast Chart -->
  <div class="chart-container mb-4" id="forecastContainer" style="display:none;">
    <h4 class="text-center mb-4">üîÆ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡πÇ‡∏î‡∏¢ Ai ‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏§‡∏©‡∏è‡∏µ</h4>
    <canvas id="forecastChart" height="100"></canvas>
  </div>

  <!-- DataTable -->
  <div class="chart-container">
    <h4 class="text-center mb-4">üìä ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
    <table id="dataTable" class="table table-striped table-hover">
      <thead class="table-light">
        <tr>
          <th>‡∏õ‡∏µ</th><th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</th><th>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</th><th>‡∏Å‡∏≥‡πÑ‡∏£</th><th>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡πâ‡∏≠‡∏¢</th><th>Yield</th><th>ROI (%)</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <!-- Contact Button -->
  <div class="text-center mt-4">
    <a href="tel:0902969884" class="btn btn-ai btn-lg">
      ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Wittawat.k $kywalker
    </a>
  </div>

</div>

<footer class="mt-5">
  ‚öôÔ∏è Quantum Sugar AI | ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡∏° Data Science | Powered by AI & Quantum Insight | ¬© 2024
</footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

<script>
const api = "https://script.google.com/macros/s/AKfycbzrVLLUSjKiq7CDpX6H1EwYzXmo_hRiqRKMiextzxUidywAY_kfNXeyHUl8nDJG6KIyzw/exec";
let forecastVisible = false;

// ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á + ‡πÅ‡∏ú‡∏ô‡∏†‡∏π‡∏°‡∏¥
async function fetchData() {
  const res = await fetch(api);
  const data = await res.json();

  const totalRevenue = data.reduce((s, d) => s + +d.revenue, 0);
  const totalProfit = data.reduce((s, d) => s + (+d.revenue - +d.cost), 0);
  const totalCane = data.reduce((s, d) => s + +d.totalCane, 0);
  const avgROI = (data.reduce((s, d)=> s + +d.roi, 0) / data.length).toFixed(2);

  document.getElementById("totalRevenue").innerText = totalRevenue.toLocaleString() + " ‡∏ø";
  document.getElementById("totalProfit").innerText = totalProfit.toLocaleString() + " ‡∏ø";
  document.getElementById("totalCane").innerText = totalCane.toLocaleString() + " ‡∏ï‡∏±‡∏ô";
  document.getElementById("avgROI").innerText = avgROI + " %";

  const years = data.map(d => d.year);
  const profits = data.map(d => +d.revenue - +d.cost);
  const yields = data.map(d => +d.yield);
  const canes = data.map(d => +d.totalCane);
  const rois = data.map(d => +d.roi);

  // Trend Chart
  new Chart(document.getElementById('trendChart').getContext('2d'), {
    type:'line',
    data:{
      labels: years,
      datasets:[
        {label:'‡∏Å‡∏≥‡πÑ‡∏£ (‡∏ø)', data: profits, borderColor:'#42a5f5', fill:false},
        {label:'Yield', data: yields, borderColor:'#8e24aa', fill:false},
        {label:'‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡πâ‡∏≠‡∏¢', data: canes, borderColor:'#ffa726', fill:false},
        {label:'ROI (%)', data: rois, borderColor:'#ef5350', fill:false},
      ]
    },
    options:{responsive:true, scales:{y:{beginAtZero:true}}}
  });

  // Forecast Chart (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
  const futureYears = ["2568","2569","2570"];
  const forecastData = {
    rev: [1600000000,1720000000,1800000000],
    cost: [1080000000,1150000000,1200000000],
    yield: [121.5,122.8,124.0],
    cane: [1350000,1380000,1420000],
    roi: [48.1,49.5,50.2]
  };
  const profitF = forecastData.rev.map((r,i)=>r - forecastData.cost[i]);
  new Chart(document.getElementById('forecastChart').getContext('2d'), {
    type:'line',
    data:{
      labels: futureYears,
      datasets:[
        {label:'‡∏Å‡∏≥‡πÑ‡∏£ (‡∏ø)', data: profitF, borderColor:'#29b6f6', fill:false},
        {label:'Yield', data: forecastData.yield, borderColor:'#7e57c2', fill:false},
        {label:'‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏≠‡πâ‡∏≠‡∏¢', data: forecastData.cane, borderColor:'#ffa726', fill:false},
        {label:'ROI (%)', data: forecastData.roi, borderColor:'#ef5350', fill:false},
      ]
    },
    options:{responsive:true, scales:{y:{beginAtZero:true}}}
  });

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß DataTable
  data.forEach(d => {
    const p = +d.revenue - +d.cost;
    $('#tableBody').append(`
      <tr>
        <td>${d.year}</td>
        <td>${(+d.revenue).toLocaleString()}</td>
        <td>${(+d.cost).toLocaleString()}</td>
        <td>${p.toLocaleString()}</td>
        <td>${(+d.totalCane).toLocaleString()}</td>
        <td>${d.yield}</td>
        <td>${(+d.roi).toFixed(2)}</td>
      </tr>`);
  });

  $('#dataTable').DataTable({
    paging: true,
    searching: true,
    lengthMenu: [5,10,25],
    language: {
      search: "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:",
      lengthMenu: "‡πÅ‡∏™‡∏î‡∏á _MENU_ ‡πÅ‡∏ñ‡∏ß",
      paginate: { "previous": "‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤", "next": "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ" }
    }
  });

  $('#toggleForecast').click(() => {
    forecastVisible = !forecastVisible;
    $('#forecastContainer').toggle(forecastVisible);
  });
}

$(document).ready(fetchData);
</script>
</body>
</html>
