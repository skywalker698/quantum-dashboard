<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="manifest" href="https://script.google.com/macros/s/AKfycbzrVLLUSjKiq7CDpX6H1EwYzXmo_hRiqRKMiextzxUidywAY_kfNXeyHUl8nDJG6KIyzw/exec?path=manifest.json" />
  <title>AI Quantum Dashboard ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•</title>

  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.bootstrap5.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: 'Prompt', sans-serif; background-color: #f8fafc; }
    .container { max-width: 1400px; margin-top: 40px; margin-bottom: 60px; }
    .card-box, .chart-container, .table-container, .ai-box {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
      padding: 24px;
      margin-bottom: 24px;
    }
    .navbar { background-color: #0f172a; }
    .navbar-brand, .nav-link { color: #fff !important; }
    .footer { background: #0f172a; color: white; padding: 12px; text-align: center; position: fixed; bottom: 0; width: 100%; }
    .chart-title { text-align: center; font-size: 1.5rem; margin-bottom: 12px; color: #0f172a; }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg shadow-sm">
  <div class="container">
    <a class="navbar-brand" href="#">üìä AI Quantum Dashboard</a>
    <ul class="navbar-nav ms-auto">
      <li class="nav-item"><a class="nav-link" href="#">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
      <li class="nav-item"><a class="nav-link" href="#">üìà ‡∏Å‡∏£‡∏≤‡∏ü</a></li>
      <li class="nav-item"><a class="nav-link" href="#">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a></li>
    </ul>
  </div>
</nav>

<!-- Content -->
<div class="container">

  <!-- Summary Section -->
  <div class="row card-box text-center">
    <div class="col-md-3"><h6>‡∏´‡∏µ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</h6><h4>18,000 ‡∏ï‡∏±‡∏ô</h4></div>
    <div class="col-md-3"><h6>‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h6><h4>19,000 ‡∏ï‡∏±‡∏ô</h4></div>
    <div class="col-md-3"><h6>Yield ‡∏õ‡∏µ 67/68</h6><h4>120.8</h4></div>
    <div class="col-md-3"><h6>‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h6><h4>500 ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó</h4></div>
  </div>

  <!-- Chart Yield vs ROI -->
  <div class="chart-container">
    <div class="chart-title">üîç ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô & Yield</div>
    <canvas id="yieldRoiChart" height="100"></canvas>
  </div>

  <!-- AI Advisor -->
  <div class="ai-box">
    <h5>ü§ñ ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å Quantum AI:</h5>
    <p id="aiAdvice" class="text-muted">
      ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...
    </p>
  </div>

  <!-- Table Section -->
  <div class="table-container">
    <h2 class="text-center">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</h2>
    <table id="businessTable" class="table table-striped" style="width:100%">
      <thead class="table-dark">
        <tr>
          <th>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
          <th>‡∏ù‡πà‡∏≤‡∏¢</th>
          <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</th>
          <th>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</th>
          <th>‡∏Å‡∏≥‡πÑ‡∏£</th>
          <th>ROI (%)</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>
</div>

<!-- Footer -->
<div class="footer">
  ¬© Quantum AI Dashboard 2567 ‚Äî ‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• & ‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js"></script>

<script>
  const apiURL = "https://script.google.com/macros/s/AKfycbzrVLLUSjKiq7CDpX6H1EwYzXmo_hRiqRKMiextzxUidywAY_kfNXeyHUl8nDJG6KIyzw/exec";

  async function fetchData() {
    const res = await fetch(apiURL);
    const data = await res.json();

    // Summary Calculation
    const totalProfit = data.reduce((sum, r) => sum + (parseFloat(r.revenue) - parseFloat(r.cost)), 0);
    const avgYield = 120.8;
    const maxCane = 19000;
    const avgCane = 18000;
    const prob = (avgCane / maxCane * 100).toFixed(2);

    // AI Advice Logic (quantum style üòé)
    const aiAdvice = `
      ‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å Quantum AI:
      ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏´‡∏µ‡∏ö‡∏≠‡πâ‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${prob}% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
      ‡∏≠‡∏±‡∏ï‡∏£‡∏≤ Yield ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö ${avgYield} ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ ‚Äú‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‚Äù
      ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 500 ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${Math.min(prob * 1.2, 99).toFixed(2)}%
    `;
    document.getElementById("aiAdvice").textContent = aiAdvice;

    // Chart
    const labels = data.map(row => row.activity);
    const roi = data.map(row => parseFloat(row.roi));
    const ctx = document.getElementById('yieldRoiChart').getContext('2d');
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: 'ROI (%)',
          data: roi,
          backgroundColor: '#22d3ee',
        }]
      },
      options: {
        responsive: true,
        scales: { y: { beginAtZero: true } }
      }
    });

    // Table
    const tbody = document.getElementById("tableBody");
    data.forEach(row => {
      const rev = parseFloat(row.revenue);
      const cost = parseFloat(row.cost);
      const profit = rev - cost;
      const roi = rev ? ((profit / rev) * 100).toFixed(2) : 0;
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row.activity}</td>
        <td>${row.type}</td>
        <td>${rev.toLocaleString()}</td>
        <td>${cost.toLocaleString()}</td>
        <td>${profit.toLocaleString()}</td>
        <td>${roi}</td>
      `;
      tbody.appendChild(tr);
    });
    $('#businessTable').DataTable();
  }

  window.addEventListener('DOMContentLoaded', fetchData);

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register("https://script.google.com/macros/s/AKfycbzrVLLUSjKiq7CDpX6H1EwYzXmo_hRiqRKMiextzxUidywAY_kfNXeyHUl8nDJG6KIyzw/exec?path=service-worker.js");
  }
</script>
</body>
</html>
